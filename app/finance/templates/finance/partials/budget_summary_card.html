{% load static %}

{% if current_budget %}
<div class="card mb-4">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Current Budget</h5>
    <a href="{% url 'finance:budget_dashboard' %}" class="btn btn-sm btn-outline-primary">View Details</a>
  </div>
  <div class="card-body">
    <h6 class="card-subtitle mb-3">{{ current_budget.month|date:"F Y" }}</h6>
    
    <div class="d-flex justify-content-between mb-2">
      <div>Total Income:</div>
      <div>${{ current_budget.total_income|floatformat:2 }}</div>
    </div>
    
    {% with budget_summary as summary %}
    <div class="d-flex justify-content-between mb-2">
      <div>Total Spent:</div>
      <div>${{ summary.total_spent|floatformat:2 }}</div>
    </div>
    
    <div class="d-flex justify-content-between mb-2">
      <div>Remaining:</div>
      <div>${{ summary.total_remaining|floatformat:2 }}</div>
    </div>
    
    <div class="progress mb-2">
      <div class="progress-bar bg-{{ summary.color }}" role="progressbar" 
           style="width: {{ summary.percent_spent|floatformat:0 }}%" 
           aria-valuenow="{{ summary.percent_spent|floatformat:0 }}" 
           aria-valuemin="0" aria-valuemax="100">
        {{ summary.percent_spent|floatformat:0 }}%
      </div>
    </div>
    {% endwith %}
    
    <div class="d-flex mt-3">
      <a href="{% url 'finance:budget_allocate' budget_uid=current_budget.uid %}" class="btn btn-sm btn-outline-secondary me-2">
        Edit Allocations
      </a>
      <a href="{% url 'finance:budget_setup' %}" class="btn btn-sm btn-outline-primary">
        New Budget
      </a>
    </div>
  </div>
</div>
{% else %}
<div class="card mb-4">
  <div class="card-body">
    <h5 class="card-title">No Active Budget</h5>
    <p class="card-text">You don't have a budget for the current month.</p>
    <a href="{% url 'finance:budget_setup' %}" class="btn btn-primary">
      Create Budget
    </a>
  </div>
</div>
{% endif %}